pipeline {
	agent {
        docker {    image 'node'    }
    }

  	}
	environment{
	  	
		VAR_BRANCH_NAME = "${env.BRANCH_NAME}"
		REPOSITORY = "qeema-platform/demo-repo-node"
		TAG="${env.BUILD_NUMBER}"
		IMAGE="demo_repo_node"

	

	}

	stages {

		

		
    	stage('Run Compile Pipeline') {
    		steps {
			
    			
				script {
    				
					pipelineScripts = load "compileScript-npm.groovy"
					pipelineScripts.CompileCode()
    			}
				
				
    		}
    	}

		

		stage('Run publish to nexus pipeline') {
    		steps {
				
					sh "echo hello"
					 sh " npm login --registry=https://qplatform.dev.qeema.io/nexus/repository/demo-repo-node/ --scope=@demo-user/"
					// sh " npm login "
                    // sh 'npm publish --registry=https://qplatform.dev.qeema.io/nexus/repository/demo-repo-node/  '
					sh '''
					npm set https://qplatform.dev.qeema.io/nexus/repository/demo-repo-node/:_authToken=NpmToken.xyz
					npm config list
					npm login --registry https://qplatform.dev.qeema.io/nexus/repository/demo-repo-node/:_authToken=xyz --auth-type=legacy
					npm publish  --registry https://qplatform.dev.qeema.io/nexus/repository/demo-repo-node/:_authToken=NpmToken.xyz
					'''
				}
    		
    	}
		
		

	}
}	
